package handlers

import (
	"JacFARM/internal/http/dto"

	"github.com/gofiber/fiber/v3"
)

func (h *Handlers) ListExploits() func(c fiber.Ctx) error {
	return func(c fiber.Ctx) error {
		filter, err := dto.MapQueryToGetExploitsFilter(c.Queries())
		if err != nil {
			return c.JSON(dto.Error(err.Error()))
		}

		exploits, err := h.service.ListExploits(c.RequestCtx(), filter)
		if err != nil {
			return c.JSON(dto.ErrInternal)
		}

		return c.JSON(dto.GetExploitsResponse{
			Response: dto.OK(),
			Exploits: exploits,
		})
	}
}

func (h *Handlers) UploadExploit() func(c fiber.Ctx) error {
	return func(c fiber.Ctx) error {
		panic("not implemented")
	}
}
